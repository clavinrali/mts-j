{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Machine Info</title>
  <link rel="stylesheet" href="{% static 'css/machine_info_styles.css' %}" />

</head>
<body>
  <div class="container">
    <header class="header">
      <h1>Machine Information</h1>
      <div class="user-bubble">{{ request.user.get_full_name }} - {{ request.user.profile.role }}</div>
    </header>

    <div class="content-grid">
      <!-- Left Panel: Machine Details -->
      <div class="card">
        <div class="section-header">
          <span>Machine Details</span>
          {% if machine.current_case %}
          <button class="btn" onclick="window.location.href='/api/case/{{ machine.current_case.id }}/'">View Case</button>
          {% endif %}
        </div>

        <div class="machine-details">
          <p><strong>Machine Name:</strong> {{ machine.name }}</p>
          <p><strong>ID:</strong> {{ machine.unique_machine_id }}</p>
          <p><strong>Model:</strong> {{ machine.model }}</p>
          <p><strong>Manufacturer:</strong> {{ machine.manufacturer }}</p>
          <p><strong>Location:</strong> {{ machine.location }}</p>
          <p><strong>Last Service Date:</strong> {{ machine.last_service }}</p>
          <p><strong>Status:</strong> <span id="{{ machine.status }}-status">{{ machine.status }}</span></p>
        </div>

        <div class="section-header" style="margin-top: 30px;">
          <span>Warnings</span>
          <div>
            <button class="btn" onclick="window.location.href='/api/machine/{{ machine.id }}/add_warning/'">Add</button>
          </div>
        </div>

        <div class="warning-list">
          {% for warning in warnings %}
          <div class="warning-item">⚠️ {{ warning.status }}</div>
          {% empty %}
          <p>No warnings available.</p>
          {% endfor %}
        </div>

        <div class="section-header" style="margin-top: 30px;">
          <span>Case History</span>
        </div>
        <div class="case-history">
          {% for case in cases %}
          <div class="case">Case #{{ case.id }} – {{ case.title }}</div>
          {% empty %}
          <p>No case history available.</p>
          {% endfor %}
        </div>

        <div class="footer-buttons">
          <button class="btn grey" onclick="window.location.href='{% url 'machine:dashboard' %}'">Go to Dashboard</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
